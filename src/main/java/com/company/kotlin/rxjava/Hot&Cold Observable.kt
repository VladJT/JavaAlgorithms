package com.company.kotlin.rxjava

import io.reactivex.rxjava3.core.Observable
import java.util.concurrent.TimeUnit


/**
 * –ì–æ—Ä—è—á–∏–π Observable –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –ø–æ–¥–ø–∏—Å–∞–Ω –∫—Ç–æ-–Ω–∏–±—É–¥—å –Ω–∞ –Ω–µ–≥–æ –∏–ª–∏ –Ω–µ—Ç.
–ï—Å–ª–∏ –Ω–∏–∫—Ç–æ –µ–≥–æ –≤ —ç—Ç–æ –≤—Ä–µ–º—è –Ω–µ —Å–ª—É—à–∞–µ—Ç, –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —É–¥–æ–±–µ–Ω, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è
–æ–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è —Å–æ–∫–µ—Ç–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ç–∞–º –∏–¥—É—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ.

 */

fun main() {
    val hotObservable = createHotObservable()
    //hotObservable.connect()
    println("start")
    Thread.sleep(1000)
    println("start_2")

    hotObservable.subscribe { println("üè≥Ô∏è‚Äç = $it") }
    Thread.sleep(2000)
    hotObservable.subscribe { println("üßë = $it") }

    readln()
}

fun createHotObservable() = Observable.interval(500, TimeUnit.MILLISECONDS).share()

/**

 publish - connect _ –Ω–∏–∫–æ–≥–æ –Ω–µ –∂–¥–µ–º , –Ω–µ –∫–µ—à–∏—Ä—É–µ—Ç , –∑–∞–ø—É—Å–∫ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ connect

share - –≥–æ—Ä—è—á–∏–π –ø–æ—Ç–æ–∫ (–∂–¥–µ—Ç –ø–µ—Ä–≤–æ–≥–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –∏ –∑–∞—Ç–µ–º –Ω–µ –∫–µ—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ)

Replay
–û—Ç–ª–∏—á–∏–µ –≤ —Ç–æ–º, —á—Ç–æ –º–µ—Ç–æ–¥ –∫—ç—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∏ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–¥–ø–∏—Å—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä
–¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞, –ø—Ä–∏—à–µ–¥—à–∏–µ –¥–æ –ø–æ–¥–ø–∏—Å–∫–∏, –∫–æ–≥–¥–∞ –±—ã –æ–Ω –Ω–∏ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è. –ú–æ–∂–Ω–æ
–ø–æ–¥—É–º–∞—Ç—å, —á—Ç–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –ø–æ–ª—É—á–∞–µ–º –æ–±—ã—á–Ω—ã–π —Ö–æ–ª–æ–¥–Ω—ã–π Observable, –Ω–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫. –ù–∞—à
–∏—Å—Ç–æ—á–Ω–∏–∫ –≤—Å—ë –µ—â—ë –≥–æ—Ä—è—á–∏–π –∏ –µ–≥–æ —Ä–∞–±–æ—Ç–∞ –Ω–∞—á–Ω—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ connect().


RefCount
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å–¥–µ–ª–∞–µ—Ç –∏–∑ ConnectableObservable Observable, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–Ω—ë—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ
–ø–æ—è–≤–∏—Ç—Å—è –ø–µ—Ä–≤—ã–π –ø–æ–¥–ø–∏—Å—á–∏–∫.
–ó–¥–µ—Å—å –Ω–µ—Ç –º–µ—Ç–æ–¥–∞ connect(), —Ç–∞–∫ –∫–∞–∫ –∫–ª–∞—Å—Å ConnectableObservable, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º publish(),
–æ–±—ë—Ä–Ω—É—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –∫–ª–∞—Å—Å Observable, –±–ª–∞–≥–æ–¥–∞—Ä—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–µ—Ç–æ–¥–∞ refCount(). –ü—Ä–∏ —Ç–∞–∫–æ–π
–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º—ã –ø–æ–ª—É—á–∞–µ–º –≥–æ—Ä—è—á–∏–π Observable, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥—ë—Ç —Å–µ–±—è –∫–∞–∫ —Ö–æ–ª–æ–¥–Ω—ã–π. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ —ç—Ç–æ
–∏–º–µ–Ω–Ω–æ –≥–æ—Ä—è—á–∏–π Observable, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–∑–¥–∞–≤–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º, –∞ –Ω–µ
—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∑–∞–Ω–æ–≤–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö.


Cache
Observable, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—è–≤–∏—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –±—É–¥–µ—Ç –ø–æ—Ö–æ–∂ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ replay() –∏ refCount(). –û–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–µ, —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏
–≤—ã–¥–∞—ë—Ç –∏—Ö –∫–∞–∂–¥–æ–º—É –Ω–æ–≤–æ–º—É –ø–æ–¥–ø–∏—Å—á–∏–∫—É, –Ω–æ –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.

 */